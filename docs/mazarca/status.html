<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mazarca SMP</title>
    <link rel="icon" type="image/x-icon" href="source/icon.png" />
    <link rel="stylesheet" href="source/css/stylesheet.css" />
</head>
<body>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const timer = document.getElementById("timer");
            getPing("https://eagler.maza64.xyz", document.getElementById("mazarca-status"), timer);
            getPing("https://www.eaglercraft.com", document.getElementById("eagler-status"), timer);
        });

        function getPing(address, output, timer) {
            output.style.color = "gray";
            output.style.textShadow = "none";
            output.innerText = "...";
            setInterval(async () => {
                let online = await async function() {
                    let cache_preventer = btoa(Date.now() + "_" + Math.random());
                    let url = address + "?" + cache_preventer;
                    let resolve;
                    fetch(url).then((v) => { resolve(true) }, (v) => { resolve(false) });
                    return new Promise((res) => { resolve = res });
                };
                var newDate = new Date();
                Date.prototype.timeNow = function() {
                    return ((this.getHours() < 10)?"0":"") + this.getHours() + ":"
                           + ((this.getMinutes() < 10)?"0":"") + this.getMinutes() + ":"
                           + ((this.getSeconds() < 10)?"0":"") + this.getSeconds();
                };
                currentTime = newDate.timeNow()
                if (online) {
                    console.log(`[Status Check ${currentTime}] ${address} is up`);
                    output.style.color = "#00AA00";
                    output.style.textShadow = "0px 0px 10px #00AA0060";
                    output.innerText = "Online";
                } else {
                    console.log(`[Status Check ${currentTime}] ${address} is down`);
                    output.style.color = "#AA0000";
                    output.style.textShadow = "0px 0px 10px #AA000060";
                    output.innerText = "Offline";
                };
                timer.innerText = `Last checked at ${currentTime}`;
            }, 3000);
        };
    </script>
    <header>
        <div>
            <a href="https://maza64.xyz">
                <img class="logo" src="source/cookie.png" />
            </a>
        </div>
        <div>
            <a href="https://maza64.xyz"><span class="title-text">Mazarca SMP</span></a>
        </div>
        <nav>
            <a class="page-link" href="index.html">Home</a>
            <a class="page-link" href="gallery.html">Gallery</a>
            <a class="page-link" href="news.html">News</a>
            <a class="page-link" href="slimefun.html">SF Help</a>
            <a class="page-link-active" href="status.html">Status</a>
        </nav>
        <div style="flex-grow: 1;"></div>
        <div>
            <a href="https://discord.com/invite/R6nMUHe9DK" target="_blank">
                <img class="discord-social" src="source/discord.jpg" width="35px" />
            </a>
        </div>
        <div>
            <a href="https://reddit.com/r/MazarcaSMP" target="_blank">
                <img class="reddit-social" src="source/reddit.jpg" height="35px" />
            </a>
        </div>
        <div></div>
    </header>
    <main class="wrapper">
        <div class="d-flex items-center gap-10px no-wrap" style="padding: 10px 0px">
            <p style="font-size: 2rem">Mazarca Server</p>
            <hr size="2px" color="gray" class="flex-grow-1">
            <h1 class="no-margin text-right" id="mazarca-status"></h1>
        </div>
        <div class="d-flex items-center gap-10px no-wrap" style="padding: 10px 0px">
            <p style="font-size: 2rem">Eaglercraft.com</p>
            <hr size="2px" color="gray" class="flex-grow-1">
            <h1 class="no-margin text-right" id="eagler-status"></h1>
        </div>
        <p class="text-center" id="timer">Fetching data... Please wait</p>
    </main>
</body>
</html>

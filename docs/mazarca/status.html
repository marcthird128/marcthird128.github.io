<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mazarca SMP</title>
    <link rel="icon" type="image/x-icon" href="source/icon.png" />
    <link rel="stylesheet" href="source/css/stylesheet.css" />
</head>
<body>
    <header>
        <nav>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 1024 1024">
                    <path fill="white" d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8m0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8m0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8"/>
                </svg>
            </div>
            <div class="nav">
                <a class="page-link" href="index.html">Home</a>
                <a class="page-link" href="gallery.html">Gallery</a>
                <a class="page-link" href="news.html">News</a>
                <a class="page-link-active">Status</a>
                <a class="page-link" href="slimefun.html">Slimefun Help</a>
            </div>
        </nav>
        <div>
            <a href="https://maza64.xyz">
                <img class="logo" src="source/cookie.png" />
            </a>
        </div>
        <div>
            <a href="https://maza64.xyz"><span class="title-text">Mazarca SMP</span></a>
        </div>
        <div style="flex-grow: 1;"></div>
        <div>
            <a href="https://discord.com/invite/R6nMUHe9DK" target="_blank">
                <img class="discord-social" src="source/discord.jpg" width="35px" />
            </a>
        </div>
        <div>
            <a href="https://reddit.com/r/MazarcaSMP" target="_blank">
                <img class="reddit-social" src="source/reddit.jpg" height="35px" />
            </a>
        </div>
    </header>
    <main class="wrapper">
        <div class="d-flex items-center gap-10px no-wrap" style="padding: 10px 0px; font-size: 2rem">
            <p>Mazarca Server</p>
            <hr size="2px" color="gray" class="flex-grow-1">
            <p class="no-margin font-bold" id="mazarca-status"></p>
        </div>
        <div class="d-flex items-center gap-10px no-wrap" style="padding: 10px 0px; font-size: 2rem">
            <p>Eaglercraft.com</p>
            <hr size="2px" color="gray" class="flex-grow-1">
            <p class="no-margin font-bold" id="eagler-status"></p>
        </div>
        <p class="text-center" id="timer">Fetching data... Please wait</p>
    </main>
    <script>
        const timer = document.getElementById("timer");

        function getPing(address, output, timer) {
            output.style.color = "gray";
            output.style.textShadow = "none";
            output.innerText = "...";
            setInterval(async () => {
                let online = await async function() {
                    let cache_preventer = btoa(Date.now() + "_" + Math.random());
                    let url = address + "?" + cache_preventer;
                    let resolve;
                    fetch(url).then((v) => { resolve(true) }, (v) => { resolve(false) });
                    return new Promise((res) => { resolve = res });
                };
                var newDate = new Date();
                Date.prototype.timeNow = function() {
                    return ((this.getHours() < 10)?"0":"") + this.getHours() + ":"
                           + ((this.getMinutes() < 10)?"0":"") + this.getMinutes() + ":"
                           + ((this.getSeconds() < 10)?"0":"") + this.getSeconds();
                };
                currentTime = newDate.timeNow()
                if (online) {
                    console.log(`[Status Check ${currentTime}] ${address} is up`);
                    output.style.color = "#00AA00";
                    output.style.textShadow = "0px 0px 10px #00AA0060";
                    output.innerText = "Online";
                } else {
                    console.log(`[Status Check ${currentTime}] ${address} is down`);
                    output.style.color = "#AA0000";
                    output.style.textShadow = "0px 0px 10px #AA000060";
                    output.innerText = "Offline";
                };
                timer.innerText = `Last checked at ${currentTime}`;
            }, 3000);
        };

        getPing("https://eagler.maza64.xyz", document.getElementById("mazarca-status"), timer);
        getPing("https://www.eaglercraft.com", document.getElementById("eagler-status"), timer);
    </script>
</body>
</html>